---
- name: Ensure ngircd is installed
  tags: ngircd
  yum:
    enablerepo: epel
    name: ngircd
    state: present
    update_cache: yes
  register: ngircd_yum

- block:
  - name: Applying ngircd configuration
    template:
      src: ngircd.conf.j2
      dest: /etc/ngircd.conf
      owner: root
      group: ngircd
      mode: 0660
    notify: restart ngircd

  - name: Create message of the day
    template:
      src: ngircd.motd.j2
      dest: /etc/ngircd.motd
      owner: root
      group: ngircd
      mode: 0660
    notify: restart ngircd
    when: ngircd_motd is defined

  - name: Ensure ngircd is running and enabled on boot
    service:
      enabled: yes
      name: ngircd
      state: started
  tags: ngircd
  when: ngircd_yum|success
...
